(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0c8a6f"],{5691:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("piaf-breadcrumb"),t._v(" "),s("b-tabs",t._l(t.currentCompanies,(function(t,e){return s("b-tab",{key:e,attrs:{title:t.name}},[s("b-card",{staticClass:"rounded-0"},[s("TableRegion",{attrs:{company:t,i:e}})],1)],1)})),1)],1)},n=[],i=s("5530"),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.company.payments.isLoading?s("div",{staticClass:"inner"},[s("div",{staticClass:"loading"})]):t.errorPayments.status?s("div",{staticClass:"text-center w-100"},[t._v("\n    "+t._s(t.errorPayments.text)+"\n  ")]):t._e(),t._v(" "),s("div"),t._v(" "),s("b-row",[s("b-colxx",{attrs:{cols:"12"}},[s("NewAdd",{attrs:{company:t.company,i:t.i}}),t._v(" "),s("div",{staticClass:"top-right-button-container"},[s("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.new-add-payment",modifiers:{"new-add-payment":!0}}],staticClass:"top-right-button",attrs:{variant:"primary",size:"lg"}},[t._v(t._s(t.$t("payments.newPayment")))]),t._v(" "),s("b-button-group",[s("b-dropdown",{staticClass:"check-button",attrs:{split:"",right:"",variant:"primary"},on:{click:function(e){return t.selectAll(!0)}}},[s("label",{staticClass:"custom-control custom-checkbox pl-4 mb-0 d-inline-block",attrs:{slot:"button-content"},slot:"button-content"},[s("input",{directives:[{name:"shortkey",rawName:"v-shortkey",value:{select:["ctrl","a"],undo:["ctrl","d"],space:["space"]},expression:"{ select: ['ctrl', 'a'], undo: ['ctrl', 'd'], space: ['space'] }"}],staticClass:"custom-control-input",attrs:{type:"checkbox"},domProps:{checked:t.isSelectedAll},on:{shortkey:t.keymap}}),t._v(" "),s("span",{class:{"custom-control-label":!0,indeterminate:t.isAnyItemSelected}},[t._v("Â ")])]),t._v(" "),s("b-dropdown-item",{attrs:{disabled:0==t.selectedItems.length},on:{click:function(e){return t.onConfirm(1)}}},[t._v(t._s(t.$t("payments.multiDoActive",{length:t.selectedItems.length})))]),t._v(" "),s("b-dropdown-item",{attrs:{disabled:0==t.selectedItems.length},on:{click:function(e){return t.onConfirm(0)}}},[t._v(t._s(t.$t("payments.multiDoOffline",{length:t.selectedItems.length})))])],1)],1)],1)],1),t._v(" "),s("b-row",[s("b-colxx",[s("div",{staticClass:"mb-4"},[s("b-button-group",{attrs:{variant:"outline-primary",size:"xs"}},[s("b-button",{attrs:{size:"xs",variant:-1==t.filter.show?"primary":"outline-primary"},on:{click:function(e){t.filter.show=-1}}},[t._v(t._s(t.$t("payments.showAll")))]),t._v(" "),s("b-button",{attrs:{size:"xs",variant:1==t.filter.show?"primary":"outline-primary"},on:{click:function(e){t.filter.show=1}}},[t._v(t._s(t.$t("payments.showOnline")))]),t._v(" "),s("b-button",{attrs:{size:"xs",variant:0==t.filter.show?"primary":"outline-primary"},on:{click:function(e){t.filter.show=0}}},[t._v(t._s(t.$t("payments.showOffline")))])],1)],1)])],1),t._v(" "),t.company.payments.isLoading?t._e():s("b-colxx",{attrs:{xxs:"12"}},[s("b-card",[t._l(t.filterPayments,(function(e,a){return s("CardList",{key:a,staticClass:"my-4",attrs:{paymentIndex:a,selectedItems:t.selectedItems,data:e,company:t.company,i:t.i},on:{"toggle-item":t.toggleItem}})})),t._v(" "),0==t.filterPayments.length?s("div",{staticClass:"text-center"},[t._v("\n        "+t._s(t.$t("error.empty"))+"\n      ")]):t._e()],2)],1)],1),t._v(" "),s("v-contextmenu",{ref:"contextmenu"},[s("v-contextmenu-item",{on:{click:function(e){return t.onContextMenuAction("copy")}}},[s("i",{staticClass:"simple-icon-docs"}),t._v(" "),s("span",[t._v("Copy")])]),t._v(" "),s("v-contextmenu-item",{on:{click:function(e){return t.onContextMenuAction("move-to-archive")}}},[s("i",{staticClass:"simple-icon-drawer"}),t._v(" "),s("span",[t._v("Move to archive")])]),t._v(" "),s("v-contextmenu-item",{on:{click:function(e){return t.onContextMenuAction("delete")}}},[s("i",{staticClass:"simple-icon-trash"}),t._v(" "),s("span",[t._v("Delete")])])],1),t._v(" "),s("b-modal",{attrs:{id:"multi-action-update","hide-header":"","no-close-on-backdrop":"","hide-footer":"",centered:""}},[t.multiUpdateLoading?s("div",{staticClass:"inner"},[s("div",{staticClass:"loading"})]):s("div",{staticClass:"text-center"},[s("i",{staticClass:"simple-icon-check text-success",staticStyle:{"font-size":"32px"}})]),t._v(" "),s("div",{staticClass:"text-center"},[t._v("\n      "+t._s(t.$t("payments.multiActionProcessing",{success:t.successMultiActions,length:t.selectedItems.length}))+"\n    ")]),t._v(" "),s("div",{staticClass:"mt-4 text-center"},[s("small",[t._v(t._s(t.$t("alertMessage.autoCloseActionProcess")))])])])],1)},o=[],r=s("2909"),d=s("1da1"),l=(s("96cf"),s("4de4"),s("d81d"),s("fb6a"),s("caad"),s("2532"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-card",{class:{"d-flex flex-row":!0,active:t.selectedItems.includes(t.data.id)},attrs:{"no-body":""},on:{click:function(e){return e.preventDefault(),t.toggleItem(e,t.data.id)}}},[s("div",{staticClass:"d-flex text-white w-10 align-items-center justify-content-center",class:{"bg-success":1==t.data.isActive,"bg-danger":0==t.data.isActive},staticStyle:{"border-radius":"5px"}},[s("h1",{staticClass:"p-0 m-0"},[t._v(t._s(t.returnName))])]),t._v(" "),s("list-actions",{attrs:{paymentIndex:t.paymentIndex,company:t.company,i:t.i,selectedItems:t.selectedItems,data:t.data}})],1)}),u=[],m=(s("b0c0"),function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pl-2 d-flex flex-grow-1 min-width-zero"},[s("div",{staticClass:"card-body align-self-center d-flex flex-column flex-lg-row justify-content-between min-width-zero align-items-lg-center"},[s("div",{staticClass:"w-30 w-sm-100",attrs:{to:"/app/products/"+t.data.id}},[s("p",{staticClass:"list-item-heading mb-0 truncate"},[t._v(t._s(t.data.name))])]),t._v(" "),s("div",{staticClass:"w-25 w-sm-100"},[t._v("\n              "+t._s(t.data.description)+"\n          ")]),t._v(" "),s("div",{staticClass:"w-15 w-sm-100"},[s("dropdown-actions",{attrs:{"payment-index":t.paymentIndex,company:t.company,i:t.i,data:t.data}})],1)]),t._v(" "),s("div",{staticClass:"custom-control custom-checkbox pl-1 align-self-center pr-4"},[s("b-form-checkbox",{staticClass:"itemCheck mb-0",attrs:{checked:t.selectedItems.includes(t.data.id)}})],1)])}),p=[],h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("b-button",{attrs:{variant:1==t.data.isActive?"danger":"success"},on:{click:function(e){return t.setItem("circle","isActive",t.data.isActive,"oldIsActive",1==t.data.isActive?0:1)}}},[t._v(" "+t._s(t.$t("general."+(1==t.data.isActive?"remove":"doActive"))))]),t._v(" "),t.show?s("div",[s("b-modal",{attrs:{"ok-disabled":t.alert.status||t.isLoading,"ok-title":t.isLoading?t.$t("general.isLoading"):t.$t("general.update"),"cancel-title":t.$t("general.close"),"ok-variant":"warning",title:t.$t("payments.updatePayment"),id:"product-update",centered:""},on:{ok:t.setUpdateProduct,hidden:function(e){t.show=!1}}},[s("div",{staticClass:"text-center"},[1==t.updateData.isActive?s("strong",{domProps:{innerHTML:t._s(t.$t("payments.isActiveDescription1"))}}):s("strong",{domProps:{innerHTML:t._s(t.$t("payments.isActiveDescription0"))}})])])],1):t._e()],1)},v=[],y=s("ade3"),f={props:["data","company","i","paymentIndex","size"],data:function(){return{isLoading:!1,show:!1,inc:[],dec:[],updateData:{val:"TL",type:"price",oldType:"oldPrice",price:this.data.price,oldPrice:this.data.price,discount:this.data.discount,oldDiscount:this.data.discount,isActive:this.data.isActive,oldIsActive:this.data.isActive},alert:{status:!1,text:""}}},watch:{"updateData.discount":function(t){this.alert=t<0?{status:!0,text:this.$t("products.alert.mustBeUp0Discount")}:t>100?{status:!0,text:this.$t("products.alert.mustBeDown100Discount")}:{status:!1}},"updateData.price":function(t){this.alert=t<0?{status:!0,text:this.$t("products.alert.mustBeUp0Price")}:{status:!1}}},methods:{toast:function(t,e,s){this.counter++,this.$bvToast.toast(e,{title:t,variant:s,toaster:"b-toaster-top-center",solid:!0})},apiResponse:function(t,e){"OK"==t.status?(this.$bvModal.hide("product-update"),this.$emit("successUpdate",e),this.$store.commit("setUpdatePayments",{data:e,index:this.i,paymentIndex:this.paymentIndex,toast:{func:this.$bvToast,data:{title:this.$t("alertMessage.success"),content:this.$t("alertMessage.updateSuccess"),variant:"success"}}})):"REGISTERED"==t.status?this.toast(this.$t("alertMessage.error"),this.$t("alertMessage.registered"),"danger"):this.toast(this.$t("alertMessage.error"),this.$t("alertMessage.error500"),"danger")},setUpdateProduct:function(t){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function s(){var a,n,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(e.isLoading=!0,t.preventDefault(),a={},Object(y["a"])(a,e.updateData.type,e.updateData[e.updateData.type]),Object(y["a"])(a,"id",e.data.id),n=a,"isActive"!=e.updateData.type){s.next=11;break}return console.log(n),s.next=7,e.$api.post("companyPayment/putCompanyPayment",n);case 7:i=s.sent,e.apiResponse(i,n),s.next=12;break;case 11:e.alert={status:!0,text:e.$t("error.empty")};case 12:e.isLoading=!1;case 13:case"end":return s.stop()}}),s)})))()},setFastlyDiscount:function(){this.inc=[{count:5,text:this.$t("products.increment",{data:"5 ".concat(this.updateData.val)})},{count:10,text:this.$t("products.increment",{data:"10 ".concat(this.updateData.val)})},{count:20,text:this.$t("products.increment",{data:"20 ".concat(this.updateData.val)})},{count:25,text:this.$t("products.increment",{data:"25 ".concat(this.updateData.val)})}],this.dec=[{count:5,text:this.$t("products.decrement",{data:"5 ".concat(this.updateData.val)})},{count:10,text:this.$t("products.decrement",{data:"10 ".concat(this.updateData.val)})},{count:20,text:this.$t("products.decrement",{data:"20 ".concat(this.updateData.val)})},{count:25,text:this.$t("products.decrement",{data:"25 ".concat(this.updateData.val)})}]},setFastlyPrice:function(){this.inc=[{count:.5,text:this.$t("products.increment",{data:"0.50 ".concat(this.updateData.val)})},{count:1,text:this.$t("products.increment",{data:"1 ".concat(this.updateData.val)})},{count:2,text:this.$t("products.increment",{data:"2 ".concat(this.updateData.val)})},{count:2.5,text:this.$t("products.increment",{data:"2.5 ".concat(this.updateData.val)})}],this.dec=[{count:.5,text:this.$t("products.decrement",{data:"0.50 ".concat(this.updateData.val)})},{count:1,text:this.$t("products.decrement",{data:"1 ".concat(this.updateData.val)})},{count:2,text:this.$t("products.decrement",{data:"2 ".concat(this.updateData.val)})},{count:2.5,text:this.$t("products.decrement",{data:"2.5 ".concat(this.updateData.val)})}]},setItem:function(t,e,s,a,n){var i=this;this.alert={status:!1},this.updateData.type=e,this.updateData.val=t,this.updateData.oldType=a,"discount"==e?this.setFastlyDiscount():this.setFastlyPrice(),this.show=!0,setTimeout((function(){i.updateData[a]=s,i.updateData[e]="isActive"==e?n:s,i.$bvModal.show("product-update")}),250)}}},g=f,b=s("2877"),x=Object(b["a"])(g,h,v,!1,null,null,null),$=x.exports,w={components:{DropdownActions:$},props:["data","selectedItems","company","i","paymentIndex"]},_=w,I=Object(b["a"])(_,m,p,!1,null,null,null),k=I.exports,P={components:{listActions:k},computed:{returnName:function(){return this.data.name.charAt(0).toLocaleUpperCase()}},props:["data","selectedItems","company","i","paymentIndex"],data:function(){return{isLoading:!0}},methods:{toggleItem:function(t,e){console.log("here",t,e),this.$emit("toggle-item",t,e)}}},C=P,A=Object(b["a"])(C,l,u,!1,null,null,null),D=A.exports,L=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("b-modal",{attrs:{id:"new-add-payment","no-close-on-backdrop":"","ok-disabled":t.isLoading,"cancel-variant":"danger","ok-title-html":t.isLoading?"<span class='spinner-border spinner-border-sm'></span>":t.$t("general.submit"),"cancel-title":t.$t("general.close"),title:t.$t("payments.newPayment")},on:{ok:t.sendNewPayment,show:t.initPayments}},[s("InputSelect",{attrs:{items:t.getPayments,placeholder:t.$t("products.options.title"),loading:t.isLoading},on:{click:function(){var e=[],s=arguments.length;while(s--)e[s]=arguments[s];return t.setPaymentsSelect.apply(void 0,e)},loading:function(e){t.isLoading=!0},api:t.setPayments},scopedSlots:t._u([{key:"option",fn:function(e){var a=e.option;return[s("div",[t._v("\n          "+t._s(a.name)+"\n          ")])]}}])})],1)},M=[],O=s("2f62"),T=s("eb6d"),j={components:{InputSelect:T["a"]},computed:Object(i["a"])({},Object(O["c"])(["getPayments"])),props:{company:{default:function(){}},i:{default:-1}},data:function(){return{isLoading:!1,selectedItem:{id:-1}}},methods:{toast:function(t,e,s){this.counter++,this.$bvToast.toast(e,{title:t,variant:s,toaster:"b-toaster-top-center",solid:!0})},sendNewPayment:function(t){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function s(){var a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return e.isLoading=!0,t.preventDefault(),s.next=4,e.$api.post("companyPayment/addCompanyPayment",{paymentTypeId:e.selectedItem.id,companyId:e.company.id});case 4:a=s.sent,"OK"==a.status?(e.$store.commit("setNewPayments",Object(i["a"])(Object(i["a"])({},e.selectedItem),{},{paymentTypeId:e.selectedItem.id,id:a.data.companyPaymentId,isActive:1,index:e.i})),e.toast(e.$t("alertMessage.success"),e.$t("alertMessage.success"),"success"),e.$bvModal.hide("new-add-payment")):"REGISTERED"==a.status?e.toast(e.$t("alertMessage.error"),e.$t("alertMessage.registered"),"danger"):e.toast(e.$t("alertMessage.error"),e.$t("alertMessage.error500"),"danger"),e.isLoading=!1;case 7:case"end":return s.stop()}}),s)})))()},setPayments:function(t){console.log(t),this.isLoading=!1},setPaymentsSelect:function(t){console.log(t),this.selectedItem=t},initPayments:function(){var t=this;return Object(d["a"])(regeneratorRuntime.mark((function e(){var s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(0!=t.getPayments.length){e.next=7;break}return t.isLoading=!0,e.next=4,t.$api.post("generate/get/paymentType",{limit:25,offset:1,filter:"isActive=1"});case 4:s=e.sent,"OK"==s.status?t.$store.commit("setPaymentsType",s.data):t.$store.commit("setPaymentsType",[]),t.isLoading=!1;case 7:case"end":return e.stop()}}),e)})))()}}},R=j,S=Object(b["a"])(R,L,M,!1,null,null,null),E=S.exports,U={components:{CardList:D,NewAdd:E},computed:{filterPayments:function(){var t=this;return-1==this.filter.show?this.company.payments.data:this.company.payments.data.filter((function(e){return e.isActive==t.filter.show}))},isSelectedAll:function(){return this.selectedItems.length>=this.company.payments.data.length},isAnyItemSelected:function(){return this.selectedItems.length>0&&this.selectedItems.length<this.company.payments.data.length}},props:{company:{default:function(){}},i:{default:-1}},watch:{"company.payments.isLoading":function(t){t||(this.filter.show=-1)}},data:function(){return{multiUpdateLoading:!1,successMultiActions:0,filter:{show:-1},selectedItems:[],errorPayments:{status:!1,text:this.$t("error.empty")},isLoading:!0,pageCount:1,items:[],fields:[{key:"name",label:this.$t("payments.type"),sortable:!0},{key:"description",label:this.$t("payments.description"),sortable:!0},{key:"isActive",label:this.$t("payments.status")},{key:"action",label:this.$t("payments.action")}]}},methods:{onConfirm:function(t){var e=this,s=this.$createElement,a=s("div",{domProps:{innerHTML:this.$t("payments.isActiveDescription".concat(t))}});this.$bvModal.msgBoxConfirm(a,{size:"md",buttonSize:"sm",okVariant:"warning",cancelVariant:"danger",okTitle:this.$t("general.submit"),cancelTitle:this.$t("general.close"),footerClass:"p-2",hideFooter:!0,hideHeader:!0,centered:!0}).then((function(s){s&&e.multiPaymentProcess(t)}))},multiPaymentProcess:function(t){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function s(){var a,n,i,c;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:e.successMultiActions=0,e.multiUpdateLoading=!0,e.$bvModal.show("multi-action-update"),a=0;case 4:if(!(a<e.selectedItems.length)){s.next=15;break}return n=e.selectedItems[a],i={id:n,isActive:t},s.next=9,e.updatePayments(i);case 9:c=s.sent,"OK"==c.status&&(e.$store.commit("setUpdatePayments",{data:i,index:e.i,toast:{func:e.$bvToast,data:{title:e.$t("alertMessage.success"),content:e.$t("alertMessage.updateSuccess"),variant:"success"}}}),e.successMultiActions++),e.selectedItems.length-1==a&&(e.multiUpdateLoading=!1,setTimeout((function(){e.$bvModal.hide("multi-action-update")}),3500));case 12:a++,s.next=4;break;case 15:case"end":return s.stop()}}),s)})))()},updatePayments:function(t){var e=this;return Object(d["a"])(regeneratorRuntime.mark((function s(){var a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,e.$api.post("companyPayment/putCompanyPayment",t);case 2:return a=s.sent,s.abrupt("return",a);case 4:case"end":return s.stop()}}),s)})))()},selectAll:function(t){this.selectedItems.length>=this.filterPayments.length?t&&(this.selectedItems=[]):this.selectedItems=this.filterPayments.map((function(t){return t.id}))},keymap:function(t){switch(console.log(t),t.srcKey){case"select":this.selectAll(!1);break;case"undo":this.selectedItems=[];break;case"space":0!=this.selectedItems.length&&this.onConfirm(1);break}},toggleItem:function(t,e){if(console.log("worked"),t.shiftKey&&this.selectedItems.length>0){var s,a=this.filterPayments,n=this.getIndex(e,a,"id"),i=this.getIndex(this.selectedItems[this.selectedItems.length-1],a,"id");a=a.slice(Math.min(n,i),Math.max(n,i)+1),(s=this.selectedItems).push.apply(s,Object(r["a"])(a.map((function(t){return t.id}))))}else this.selectedItems.includes(e)?this.selectedItems=this.selectedItems.filter((function(t){return t!==e})):this.selectedItems.push(e)},initPayments:function(t,e){var s=this;this.$store.commit("setPayments",{isLoading:!0,index:this.i}),this.$api.post("companyPayment/getCompanyPayment",{limit:e,offset:t,companyId:this.company.id}).then((function(t){"OK"==t.status?(s.pageCount=Math.ceil(t.data[0].total/10),console.log(t),s.$store.commit("setPayments",{index:s.i,data:t.data})):(s.errorPayments,s.$t("error.empty")),s.isLoading=!1}))}},mounted:function(){this.company.payments.status||-1==this.i?this.isLoading=!1:this.initPayments()}},z=U,N=Object(b["a"])(z,c,o,!1,null,null,null),K=N.exports,F={computed:Object(i["a"])({},Object(O["c"])(["currentCompanies"])),components:{TableRegion:K}},B=F,H=Object(b["a"])(B,a,n,!1,null,null,null);e["default"]=H.exports}}]);