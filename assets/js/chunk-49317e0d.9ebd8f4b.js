(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49317e0d"],{5118:function(e,t,s){(function(e){var n="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||window,a=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(a.call(setTimeout,n,arguments),clearTimeout)},t.setInterval=function(){return new i(a.call(setInterval,n,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(n,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},s("6017"),t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(this,s("c8ba"))},6017:function(e,t,s){(function(e,t){(function(e,s){"use strict";if(!e.setImmediate){var n,a=1,i={},r=!1,o=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,"[object process]"==={}.toString.call(e.process)?f():v()?h():e.MessageChannel?g():o&&"onreadystatechange"in o.createElement("script")?p():b(),c.setImmediate=l,c.clearImmediate=u}function l(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),s=0;s<t.length;s++)t[s]=arguments[s+1];var r={callback:e,args:t};return i[a]=r,n(a),a++}function u(e){delete i[e]}function d(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(s,n);break}}function m(e){if(r)setTimeout(m,0,e);else{var t=i[e];if(t){r=!0;try{d(t)}finally{u(e),r=!1}}}}function f(){n=function(e){t.nextTick((function(){m(e)}))}}function v(){if(e.postMessage&&!e.importScripts){var t=!0,s=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=s,t}}function h(){var t="setImmediate$"+Math.random()+"$",s=function(s){s.source===e&&"string"===typeof s.data&&0===s.data.indexOf(t)&&m(+s.data.slice(t.length))};e.addEventListener?e.addEventListener("message",s,!1):e.attachEvent("onmessage",s),n=function(s){e.postMessage(t+s,"*")}}function g(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;m(t)},n=function(t){e.port2.postMessage(t)}}function p(){var e=o.documentElement;n=function(t){var s=o.createElement("script");s.onreadystatechange=function(){m(t),s.onreadystatechange=null,e.removeChild(s),s=null},e.appendChild(s)}}function b(){n=function(e){setTimeout(m,0,e)}}})("undefined"===typeof self?"undefined"===typeof e?this:e:self)}).call(this,s("c8ba"),s("4362"))},"68b4":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Chat")],1)},a=[],i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("b-row",{staticClass:"app-row"},[s("b-colxx",{staticClass:"chat-app",attrs:{xxs:"12"}},[e.isLoadConversations?s("conversation-detail",{key:"conversation",attrs:{"current-user":e.currentUser,"other-user":e.conversations[e.activeConversation],messages:e.conversationMessages}}):s("div",{key:"conversationLoading",staticClass:"loading"})],1)],1),e._v(" "),e.isSendingMessage?s("p",{staticClass:"text-center"},[e._v("\n        "+e._s(e.$t("chat.sendingMessage"))+"\n    ")]):s("p",{staticClass:"text-center w-75"},[s("small",[e._v("  "+e._s(e.$t("chat.chatDescription")))])]),e._v(" "),s("div",{staticClass:"chat-input-container d-flex justify-content-between align-items-center"},[s("b-input",{staticClass:"flex-grow-1",attrs:{disabled:e.isSendingMessage,type:"text",placeholder:e.$t("chat.saysomething")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.sendMessage.apply(null,arguments)}},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),e._v(" "),s("div",[s("b-button",{staticClass:"icon-button large ml-1",attrs:{variant:"outline-primary"}},[s("i",{staticClass:"simple-icon-paper-clip"})]),e._v(" "),s("b-button",{staticClass:"icon-button large ml-1",attrs:{disabled:e.isSendingMessage,variant:"primary"},on:{click:e.sendMessage}},[s("i",{staticClass:"simple-icon-arrow-right"})])],1)],1),e._v(" "),s("application-menu",[s("div",{staticClass:"pt-4 spaced-content pb-0 mt-2"}),e._v(" "),e.isLoadConversations?s("conversation-list",{key:"conversationList",attrs:{"current-user":e.currentUser,conversations:e.conversations,contacts:e.conversations},on:{"select-conversation":e.selectConversation}}):s("div",{key:"conversationListLoading",staticClass:"loading"})],1)],1)},r=[],o=s("1da1"),c=s("5530"),l=(s("96cf"),s("7db0"),s("caad"),s("2532"),s("a434"),s("b0c0"),s("159b"),s("2f62")),u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:{"app-menu":!0,shown:e.isOpen},on:{mouseenter:function(t){e.isMenuOver=!0},mouseleave:function(t){e.isMenuOver=!1}}},[e._t("default"),e._v(" "),s("a",{staticClass:"app-menu-button d-inline-block d-xl-none",on:{click:function(t){return t.preventDefault(),e.toggle.apply(null,arguments)}}},[s("i",{staticClass:"simple-icon-options"})])],2)},d=[],m=s("5118"),f={data:function(){return{isOpen:!1,isMenuOver:!1}},methods:{addEvents:function(){document.addEventListener("click",this.handleDocumentClick),document.addEventListener("touchstart",this.handleDocumentClick)},removeEvents:function(){document.removeEventListener("click",this.handleDocumentClick),document.removeEventListener("touchstart",this.handleDocumentClick)},handleDocumentClick:function(e){this.isMenuOver||this.toggle()},toggle:function(){this.isOpen=!this.isOpen}},watch:{isOpen:function(e){var t=this;e?(Object(m["setTimeout"])((function(){t.$emit("show")}),300),this.addEvents()):this.removeEvents()}},beforeDestroy:function(){this.removeEvents()}},v=f,h=s("2877"),g=Object(h["a"])(v,u,d,!1,null,null,null),p=g.exports,b=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("vue-perfect-scrollbar",{attrs:{settings:{suppressScrollX:!0,wheelPropagation:!1}}},[s("div",{staticClass:"pt-0 spaced-content pb-0"},e._l(e.data,(function(t,n){return s("div",{key:"contact"+n,staticClass:"d-flex flex-row mb-3 border-bottom pb-3"},[s("a",{staticClass:"d-flex",attrs:{href:"#"},on:{click:function(s){return s.preventDefault(),e.selectContact(t.id)}}},[s("img",{staticClass:"img-thumbnail border-0 rounded-circle mr-3 list-thumbnail align-self-center xsmall",attrs:{alt:t.title,src:t.img}}),e._v(" "),s("div",{staticClass:"d-flex flex-grow-1 min-width-zero"},[s("div",{staticClass:"pl-0 align-self-center d-flex flex-column flex-lg-row justify-content-between min-width-zero"},[s("div",{staticClass:"min-width-zero"},[s("p",{staticClass:" mb-0 truncate"},[e._v(e._s(t.title))])])])])])])})),0)])},C=[],_={props:["data"],methods:{selectContact:function(e){this.$emit("select-contact",e)}}},x=_,y=Object(h["a"])(x,b,C,!1,null,null,null),w=y.exports,k=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("vue-perfect-scrollbar",{staticClass:"scroll",attrs:{settings:{suppressScrollX:!0,wheelPropagation:!1}}},[s("div",{staticClass:"pt-0 spaced-content pb-0"},e._l(e.contacts,(function(t,n){return s("div",{key:"conversation"+n,staticClass:"d-flex flex-row mb-1 border-bottom pb-3"},[s("a",{staticClass:"d-flex",attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.selectConversation(e.conversation)}}},[s("img",{staticClass:"img-thumbnail border-0 rounded-circle mr-3 list-thumbnail align-self-center xsmall",attrs:{alt:t.name,src:t.img}}),e._v(" "),s("div",{staticClass:"d-flex flex-grow-1 min-width-zero"},[s("div",{staticClass:"pl-0 align-self-center d-flex flex-column flex-lg-row justify-content-between min-width-zero"},[s("div",{staticClass:"min-width-zero"},[s("p",{staticClass:"mb-0 truncate"},[e._v(e._s(t.name))]),e._v(" "),s("p",{staticClass:"mb-1 text-muted text-small"},[0!=t.messages.length?s("span",[e._v("\n                  "+e._s(-1==t.messages[t.messages.length-1].sender?"":e.$t("chat.you")+" - ")+"\n                ")]):e._e(),e._v("\n                "+e._s(0==t.messages.length?e.$t("chat.noMessage"):t.messages[t.messages.length-1].text)+"\n              ")]),e._v(" "),0!=t.messages.length?s("p",{staticClass:"mb-1 text-muted text-right text-small"},[e._v(e._s(t.messages[t.messages.length-1].time))]):e._e()])])])])])})),0)])},M=[],O={props:["conversations","contacts","currentUser"],methods:{selectConversation:function(e){var t=this.otherUser(e.users);this.$emit("select-conversation",t,e.messages)},otherUser:function(e){return{title:this.$t("chat.helpCenter"),img:"https://api.evesoyle.com/images/default.png"}}},computed:{},mounted:function(){}},$=O,T=Object(h["a"])($,k,M,!1,null,null,null),U=T.exports,E=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"d-flex flex-row chat-heading"},[s("div",{staticClass:"d-flex"},[s("img",{staticClass:"img-thumbnail border-0 rounded-circle ml-0 mr-4 list-thumbnail align-self-center small",attrs:{alt:e.otherUser.name,src:e.otherUser.img}})]),e._v(" "),s("div",{staticClass:"d-flex min-width-zero"},[s("div",{staticClass:"card-body pl-0 align-self-center d-flex flex-column flex-lg-row justify-content-between min-width-zero"},[s("div",{staticClass:"min-width-zero"},[s("div",[s("p",{staticClass:"list-item-heading mb-1 truncate"},[e._v("\n              "+e._s(e.otherUser.name)+"\n            ")])]),e._v(" "),s("p",{staticClass:"mb-0 text-muted text-small"},[e._v(e._s(e.$t("chat.online")))])])])])]),e._v(" "),s("div",{staticClass:"separator mb-5"}),e._v(" "),s("vue-perfect-scrollbar",{ref:"chatArea",staticClass:"scroll",attrs:{settings:{suppressScrollX:!0,wheelPropagation:!1}}},[e._l(e.otherUser.messages,(function(t,n){return s("div",{key:"message"+n},[s("b-card",{class:{"d-inline-block mb-3":!0,"float-left":-1===t.sender,"float-right":t.sender===e.currentUser.id},attrs:{"no-body":""}},[s("div",{staticClass:"position-absolute pt-1 pr-2 r-0"},[s("span",{staticClass:"text-extra-small text-muted"},[e._v(e._s(t.time))])]),e._v(" "),s("b-card-body",[t.sender===e.currentUser.id?s("div",{staticClass:"d-flex flex-row pb-1"},[s("img",{staticClass:"img-thumbnail border-0 rounded-circle mr-3 list-thumbnail align-self-center xsmall",attrs:{alt:e.otherUser.name,src:e.otherUser.img}}),e._v(" "),s("div",{staticClass:"d-flex flex-grow-1 min-width-zero"},[s("div",{staticClass:"m-2 pl-0 align-self-center d-flex flex-column flex-lg-row justify-content-between min-width-zero"},[s("div",{staticClass:"min-width-zero"},[s("p",{staticClass:"mb-0 truncate list-item-heading"},[e._v("\n                    "+e._s(e.otherUser.name)+" - "),s("small",[e._v(e._s(e.$t("chat.you")))])])])])])]):s("div",{staticClass:"d-flex flex-row pb-1"},[s("img",{staticClass:"img-thumbnail border-0 rounded-circle mr-3 list-thumbnail align-self-center xsmall",attrs:{alt:e.$t("chat.helpCenter"),src:"https://api.evesoyle.com/images/default.png"}}),e._v(" "),s("div",{staticClass:"d-flex flex-grow-1 min-width-zero"},[s("div",{staticClass:"m-2 pl-0 align-self-center d-flex flex-column flex-lg-row justify-content-between min-width-zero"},[s("div",{staticClass:"min-width-zero"},[s("p",{staticClass:"mb-0 truncate list-item-heading"},[e._v("\n                    "+e._s(e.$t("chat.helpCenter"))+"\n                  ")])])])])]),e._v(" "),s("div",{staticClass:"chat-text-left"},[s("p",{staticClass:"mb-0 text-semi-muted"},[e._v(e._s(t.text))])])])],1),e._v(" "),s("div",{staticClass:"clearfix"})],1)})),e._v(" "),0==e.otherUser.messages.length?s("div",{staticClass:"text-center mt-5"},[e._v("\n      "+e._s(e.$t("error.empty"))+"\n    ")]):e._e()],2)],1)},I=[],j={props:["currentUser","otherUser"],methods:{scrollToEnd:function(){var e=this;setTimeout((function(){var t=e.$refs.chatArea.$el;t.scrollTop=t.scrollHeight}),0)}},mounted:function(){this.scrollToEnd()},updated:function(){this.scrollToEnd()}},L=j,z=Object(h["a"])(L,E,I,!1,null,null,null),D=z.exports,S={components:{"application-menu":p,"contact-list":w,"conversation-list":U,"conversation-detail":D},data:function(){return{tabIndex:0,isSendingMessage:!1,message:"",searchKey:"",isLoadCurrentConversation:!1,otherUser:null,conversationMessages:null}},computed:Object(c["a"])({},Object(l["c"])(["currentUser","currentCompanies","isLoadConversations","conversations","activeConversation"])),methods:Object(c["a"])(Object(c["a"])({},Object(l["b"])(["getContacts","searchContacts","getConversations"])),{},{selectConversation:function(e,t){this.otherUser=e,this.conversationMessages=t},selectContact:function(e){var t=this;this.otherUser=this.contacts.find((function(t){return t.id===e}));var s=this.conversations.find((function(s){return s.users.includes(e)&&s.users.includes(t.currentUser.id)}));if(s)console.log("change selected conversation"),this.conversationMessages=s.messages;else{console.log("create new conversation");var n=new Date;this.conversations.splice(0,0,{users:[e,this.currentUser.id],messages:[],lastMessageTime:n.getHours()+":"+n.getMinutes()}),this.conversationMessages=[]}this.tabIndex=0,this.message="",this.searchKey=""},sendMessage:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isSendingMessage=!0,console.log("add message to conversation"),s=new Date,t.next=5,e.$api.post("message/addMessageCC",{companyId:e.conversations[e.activeConversation].companyId,receiverId:-1,type:"0",message:e.message,name:e.currentUser.name+" "+e.currentUser.lastname});case 5:n=t.sent,"OK"==n.status?(e.$store.commit("setNewMessages",{sender:e.currentUser.id,name:e.currentUser.name+" "+e.currentUser.lastname,text:e.message,time:s.getHours()<10?"0".concat(s.getHours()):s.getHours()+":"+s.getMinutes()<10?"0".concat(s.getMinutes()):s.getMinutes()}),e.message=""):e.toast(e.$t("alertMessage.error"),e.$t("alertMessage.error500"),"danger"),e.isSendingMessage=!1;case 8:case"end":return t.stop()}}),t)})))()},toast:function(e,t,s){this.counter++,this.$bvToast.toast(t,{title:e,variant:s,toaster:"b-toaster-top-center",solid:!0})}}),mounted:function(){var e=this;this.currentCompanies.length!=this.conversations.length?this.currentCompanies.forEach((function(t,s){e.getConversations(Object(c["a"])(Object(c["a"])({},t),{},{index:s})).then((function(){s==e.currentCompanies.length-1&&e.$store.commit("setLoadConversations",!0)}))})):this.$store.commit("setLoadConversations",!0),document.body.classList.add("no-footer")},beforeDestroy:function(){document.body.classList.remove("no-footer")},watch:{searchKey:function(e,t){this.searchContacts({userId:this.currentUser.id,searchKey:e})}}},A=S,H=Object(h["a"])(A,i,r,!1,null,null,null),K=H.exports,P={components:{Chat:K}},F=P,X=Object(h["a"])(F,n,a,!1,null,null,null);t["default"]=X.exports},"7db0":function(e,t,s){"use strict";var n=s("23e7"),a=s("b727").find,i=s("44d2"),r="find",o=!0;r in[]&&Array(1)[r]((function(){o=!1})),n({target:"Array",proto:!0,forced:o},{find:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),i(r)}}]);